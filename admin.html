<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>BLACK AWARDS ‚Äî –ê–¥–º–∏–Ω–∫–∞</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at center, #2b0040, #000);
      color: white;
      font-family: Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .login-box {
      text-align: center;
    }

    .google-btn {
      padding: 16px 36px;
      font-size: 18px;
      border-radius: 40px;
      border: none;
      cursor: pointer;
      background: white;
      color: black;
      font-weight: 600;
      transition: 0.3s;
    }

    .google-btn:hover {
      transform: scale(1.08);
    }

    #results {
      max-width: 600px;
      margin-top: 30px;
    }
  </style>
</head>
<body>

<div class="login-box">
  <!-- üî• –í–û–¢ –û–ù–ê, –ö–ù–û–ü–ö–ê -->
  <button class="google-btn" id="googleLogin">
    –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
  </button>

  <div id="results"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {

  const firebaseConfig = {
  apiKey: "AIzaSyAZiHeDrbP0bXx9ZsDWqGZFw_Ljh_nhBqc",
  authDomain: "black-awards.firebaseapp.com",
  projectId: "black-awards",
  storageBucket: "black-awards.firebasestorage.app",
  messagingSenderId: "1028165098992",
  appId: "1:1028165098992:web:506d988e4d97fdb062d135",
  measurementId: "G-JHFC5J81E7"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();
  const provider = new firebase.auth.GoogleAuthProvider();

  const loginBtn = document.getElementById('googleLogin');
  const resultsDiv = document.getElementById('results');

  loginBtn.addEventListener('click', () => {
    auth.signInWithPopup(provider).catch(err => {
      alert(err.message);
      console.error(err);
    });
  });

  auth.onAuthStateChanged(async user => {
    if (!user) return;

    // üîê –ü–†–û–í–ï–†–ö–ê –ê–î–ú–ò–ù–ê
    if (user.email !== "antonov2010art–ê@gmail.com") {
      alert("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞");
      auth.signOut();
      return;
    }

    loginBtn.style.display = 'none';

    const votes = await db.collection('votes').get();
    const results = {};

    votes.forEach(doc => {
      const answers = doc.data().answers;
      for (const cat in answers) {
        if (!results[cat]) results[cat] = {};
        results[cat][answers[cat]] =
          (results[cat][answers[cat]] || 0) + 1;
      }
    });

    for (const cat in results) {
      resultsDiv.innerHTML += <h3>${cat}</h3>;
      for (const name in results[cat]) {
        resultsDiv.innerHTML += <p>${name}: ${results[cat][name]}</p>;
      }
    }
  });

});
</script>

</body>
</html>
