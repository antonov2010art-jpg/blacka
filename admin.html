<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>BLACK AWARDS ‚Äî –ê–¥–º–∏–Ω</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at center, #2b0040, #000);
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container {
      text-align: center;
      max-width: 700px;
      width: 100%;
      padding: 30px;
    }

    .google-btn {
      padding: 16px 36px;
      font-size: 18px;
      font-weight: 600;
      border-radius: 40px;
      border: none;
      cursor: pointer;
      background: #fff;
      color: #000;
      transition: 0.3s;
    }

    .google-btn:hover {
      transform: scale(1.08);
    }

    h2 {
      margin-top: 40px;
    }

    .category {
      margin-top: 30px;
      text-align: left;
    }

    .category h3 {
      margin-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.3);
      padding-bottom: 5px;
    }

    .category p {
      margin: 4px 0;
    }
  </style>
</head>
<body>

<div class="container">
  <!-- –ö–ù–û–ü–ö–ê –í–•–û–î–ê -->
  <button class="google-btn" id="googleLogin">
    –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
  </button>

  <!-- –†–ï–ó–£–õ–¨–¢–ê–¢–´ -->
  <div id="results"></div>
</div>

<script>
  const firebaseConfig = {
 apiKey: "AIzaSyAZiHeDrbP0bXx9ZsDWqGZFw_Ljh_nhBqc",
  authDomain: "black-awards.firebaseapp.com",
  projectId: "black-awards",
  storageBucket: "black-awards.firebasestorage.app",
  messagingSenderId: "1028165098992",
  appId: "1:1028165098992:web:506d988e4d97fdb062d135",
  measurementId: "G-JHFC5J81E7"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();
  const provider = new firebase.auth.GoogleAuthProvider();

  const loginBtn = document.getElementById('googleLogin');
  const resultsDiv = document.getElementById('results');

  // ===== –ö–ù–û–ü–ö–ê –í–•–û–î–ê (REDIRECT ‚Äî –ù–ï –ë–õ–û–ö–ò–†–£–ï–¢–°–Ø) =====
  loginBtn.addEventListener('click', async () => {
    try {
      await auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);
      await auth.signInWithRedirect(provider);
    } catch (e) {
      alert(e.message);
      console.error(e);
    }
  });

  // ===== –õ–û–í–ò–ú –†–ï–ó–£–õ–¨–¢–ê–¢ REDIRECT =====
  auth.getRedirectResult().catch(err => {
    console.error('Redirect error:', err);
  });

  // ===== –ü–û–°–õ–ï –í–•–û–î–ê =====
  auth.onAuthStateChanged(async user => {
    if (!user) return;

    // üîê –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–Æ GOOGLE-–ü–û–ß–¢–£
    if (user.email !== "antonov2010art@gmail.com") {
      alert("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞");
      auth.signOut();
      return;
    }

    loginBtn.style.display = 'none';
    resultsDiv.innerHTML = '<h2>–ò—Ç–æ–≥–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è</h2>';

    const snapshot = await db.collection('votes').get();
    const results = {};

    snapshot.forEach(doc => {
      const answers = doc.data().answers;
      for (const category in answers) {
        if (!results[category]) results[category] = {};
        const name = answers[category];
        results[category][name] = (results[category][name] || 0) + 1;
      }
    });

    for (const category in results) {
      const block = document.createElement('div');
      block.className = 'category';
      block.innerHTML = <h3>${category}</h3>;

      for (const name in results[category]) {
        block.innerHTML += <p>${name} ‚Äî ${results[category][name]}</p>;
      }

      resultsDiv.appendChild(block);
    }
  });
</script>

</body>
</html>

   
